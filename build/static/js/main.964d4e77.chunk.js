(this["webpackJsonprisk-allocation"]=this["webpackJsonprisk-allocation"]||[]).push([[0],{100:function(t,e,n){"use strict";e.__esModule=!0;var r=n(38),i=n(101),a=n(151);var o={scrapeStockPrice:function(t){return new Promise((function(e,n){var a="https://www.alphaquery.com/stock/"+t+"/all-data-variables";r.get(a).then((function(t){var n=t.data,r=i.load(n)('a[name="Recent Price/Volume"]').parent().parent().next().children(".text-right").text(),a=parseFloat(r);return e(a)})).catch((function(t){return"Request failed with status code 404"===t.message?n({error_message:"This is probably not a valid stock ticker. Tickers should be 1-5 characters, excluding white spaces and leading $ character."}):n({error_message:t.message})}))}))},scrapeOptImpVol:function(t){return new Promise((function(e,n){var a="https://www.alphaquery.com/stock/"+t+"/volatility-option-statistics/180-day/historical-volatility";r.get(a).then((function(t){var n=t.data,r=i.load(n)("#indicator-iv-mean").children(".indicator-figure").children("a").children(".indicator-figure-inner").text(),a=parseFloat(r);return e(a)})).catch((function(t){return"Request failed with status code 404"===t.message?n({error_message:"This is probably not a valid stock ticker. Tickers should be 1-5 characters, excluding white spaces and leading $ character."}):n({error_message:t.message})}))}))},retrieveStockInfo:function(t){return new Promise((function(e,n){var r=a.sanitizeStockTicker(t);return o.scrapeStockPrice(r).then((function(t){return Promise.all([t,o.scrapeOptImpVol(r)])})).then((function(t){var n=t[0],i=t[1];return e({success:!0,data:{ticker:r,last_price_dollars:n,opt_imp_vol_180d_pct:i,enriched:!0}})})).catch((function(t){return e({success:!1,data:t})}))}))}};e.default=o},151:function(t,e){var n={sanitizeStockTicker:function(t){var e=function(t){return"$"===t.charAt(0)?t.substring(1):t}(t.toString().replace(/\s+/g,""));return e.length>=1&&e.length<=5?e:"This is probably not a valid stock ticker. Tickers should be 1-5 characters, excluding white spaces and leading $ character."}};t.exports=n},152:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n(5),a=n.n(i),o=n(70),s=n.n(o),c=(n(79),n(80),n(19)),l=n(20),d=n(21),u=n(23),h=n(22),p=n(37),_=n.n(p),f=n(71),b=n(72),j=n(73),m=n.n(j),g=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var r;Object(c.a)(this,n),(r=e.call(this,t)).handleChange=function(t){var e=t.currentTarget.value,n=t.currentTarget.name;r.setState(Object(b.a)({},n,e),(function(){var t={ticker:r.state.ticker,shares_owned:r.state.shares_owned};r.setState({submission:t})}))},r.handleGetData=function(t){r.state.submission.ticker&&r.state.submission.shares_owned&&r.setState({submitted:!0},Object(f.a)(_.a.mark((function t(){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.retrieveStockInfoFromServer(r.state.submission).then((function(t){r.setState({index:r.props.index,capital_invested:t.capital_invested,last_price_dollars:t.last_price_dollars,opt_imp_vol_180d_pct:t.opt_imp_vol_180d_pct,one_sigma_risk:t.one_sigma_risk,error_message:t.error_message},(function(){r.props.onChange&&r.props.onChange(r.state)}))})).catch((function(t){return console.log(t)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))))},r.handleDelete=function(t){r.state.delete?r.setState({delete:!1},(function(){r.props.onDelete&&r.props.onDelete(r.props)})):r.setState({delete:!0},(function(){r.props.onDelete&&r.props.onDelete(r.props)}))};r.state={index:void 0,submitted:!1,ticker:void 0,shares_owned:void 0,submission:void 0,delete:!1,capital_invested:void 0,last_price_dollars:void 0,opt_imp_vol_180d_pct:void 0,one_sigma_risk:void 0,capital_share:void 0,risk_share:void 0,error_message:void 0};return r}return Object(l.a)(n,[{key:"render",value:function(){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:Object(r.jsx)("input",{type:"text",name:"ticker",placeholder:"Stock ticker",onChange:this.handleChange})}),Object(r.jsx)("td",{children:Object(r.jsx)("input",{type:"number",name:"shares_owned",placeholder:"Shares owned",onChange:this.handleChange})}),Object(r.jsx)("td",{children:Object(r.jsx)("button",{onClick:this.handleGetData,children:"Go!"})}),this.state.error_message?Object(r.jsx)("td",{colSpan:6,children:Object(r.jsx)("p",{style:{color:"red"},children:this.state.error_message})}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("td",{children:this.state.last_price_dollars?this.state.last_price_dollars:"..."}),Object(r.jsx)("td",{children:this.state.capital_invested?Math.round(this.state.capital_invested).toLocaleString():"..."}),Object(r.jsx)("td",{children:this.state.capital_share?(100*this.state.capital_share).toFixed(0)+"%":"..."}),Object(r.jsx)("td",{children:this.state.opt_imp_vol_180d_pct?(100*this.state.opt_imp_vol_180d_pct).toFixed(0)+"%":"..."}),Object(r.jsx)("td",{children:this.state.one_sigma_risk?Math.round(this.state.one_sigma_risk).toLocaleString():"..."}),Object(r.jsx)("td",{children:this.state.risk_share?(100*this.state.risk_share).toFixed(0)+"%":"..."})]}),Object(r.jsx)("td",{children:Object(r.jsx)("button",{onClick:this.handleDelete.bind(this),children:"Delete"})})]},this.props.index)}}],[{key:"getDerivedStateFromProps",value:function(t){return t.stateFromParent?{capital_share:t.stateFromParent.holding.capital_share,risk_share:t.stateFromParent.holding.risk_share}:{}}}]),n}(i.Component),v=n(9),k=n.n(v),x=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var r;return Object(c.a)(this,n),(r=e.call(this,t)).makeRowKeys=function(){var t=r.state.row_counter,e=r.state.row_keys,n=Array(t);1===t?r.setState({row_keys:n}):r.setState({row_keys:e})},r.incrementRowCounter=function(){var t=r.state.row_counter+1;r.state.row_keys.push(t),r.setState({row_counter:t,row_keys:r.state.row_keys})},r.deleteSelectedRows=function(t){var e=r.state.row_keys.filter((function(e){return e!=t.index})),n=r.state.submitted_holdings.filter((function(e){return e.component_index!=t.index}));n=r.addPortfolioData(n),r.setState({row_keys:e,submitted_holdings:n},(function(){var t=r.state.submitted_holdings.map((function(t){return t.holding})),e=k.a.capitalTotal(t),n=k.a.riskTotal(t);r.setState({capital_total:e,risk_total:n})}))},r.collectChildState=function(t){console.log("Collect child state started!"),console.log("Child state is: %o",t);var e={ticker:t.ticker,last_price_dollars:t.last_price_dollars,shares_owned:t.shares_owned,capital_invested:t.capital_invested,opt_imp_vol_180d_pct:t.opt_imp_vol_180d_pct,one_sigma_risk:t.one_sigma_risk,enriched:!0,portfolio:!1},n=r.state.submitted_holdings,i={component_index:t.index,holding:e},a=!1;console.log("new_or_updated holding is: %o",i),n.map((function(e){e.component_index===t.index&&(a=!0,e.holding=i.holding)})),a||(console.log("adding a new holding"),n.push(i)),r.setState({submitted_holdings:n},(function(){var t=r.state.submitted_holdings.map((function(t){return t.holding})),e=k.a.capitalTotal(t),n=k.a.riskTotal(t);r.state.submitted_holdings.map((function(t){t.holding.capital_share=t.holding.capital_invested/e,t.holding.risk_share=t.holding.one_sigma_risk/n})),r.setState({risk_total:n,capital_total:e})}))},r.addPortfolioData=function(t){var e=t.map((function(t){return t.holding})),n=k.a.createPortfolio(e);return t.map((function(t,e){return t.holding=n[e],t}))},r.getStateForChild=function(t,e){return e.filter((function(e){return e.component_index===t}))[0]},r.sumCapital=function(t){var e=t.map((function(t){return t.holding}));r.setState({capital_total:k.a.capitalTotal(e)})},r.sumRisk=function(t){var e=t.map((function(t){return t.holding}));r.setState({risk_total:k.a.riskTotal(e)})},r.state={submitted_holdings:[],disabled:!0,holding_submitted:!1,row_counter:1,row_keys:[1],risk_total:0,capital_total:0},r.deleteSelectedRows=r.deleteSelectedRows.bind(Object(d.a)(r)),r}return Object(l.a)(n,[{key:"render",value:function(){var t=this;return Object(r.jsxs)("div",{children:[Object(r.jsxs)("table",{children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"Stock ticker"}),Object(r.jsx)("th",{children:"Number of shares owned"}),Object(r.jsx)("th",{}),Object(r.jsx)("th",{children:"Last closing price ($)"}),Object(r.jsx)("th",{children:"Capital invested ($)"}),Object(r.jsx)("th",{children:"Share of capital"}),Object(r.jsx)("th",{children:"Options-implied volatility (one sigma)"}),Object(r.jsx)("th",{children:"One sigma risk ($)"}),Object(r.jsx)("th",{children:"Share of risk"}),Object(r.jsx)("th",{children:"Delete?"})]})}),Object(r.jsx)("tbody",{children:this.state.row_keys.map((function(e){return Object(r.jsx)(g,{index:e,stateFromParent:t.getStateForChild(e,t.state.submitted_holdings),onChange:t.collectChildState,onDelete:t.deleteSelectedRows},e)}))}),Object(r.jsx)("tfoot",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{colSpan:3,children:Object(r.jsx)("b",{children:"Total:"})}),Object(r.jsx)("td",{}),Object(r.jsx)("td",{children:Math.round(this.state.capital_total).toLocaleString()}),Object(r.jsx)("td",{children:"100%"}),Object(r.jsx)("td",{}),Object(r.jsx)("td",{children:Math.round(this.state.risk_total).toLocaleString()}),Object(r.jsx)("td",{children:"100%"}),Object(r.jsx)("td",{})]})})]}),Object(r.jsx)("button",{onClick:this.incrementRowCounter,children:"Add another row"})]})}}]),n}(i.Component);var O=function(){return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)("header",{className:"App-header",children:Object(r.jsxs)("p",{children:["Enter your portfolio and see where your ",Object(r.jsx)("em",{children:"risk"})," is allocated."]})}),Object(r.jsx)("div",{className:"full-container",children:Object(r.jsx)("div",{className:"container padding-top",children:Object(r.jsx)(x,{})})}),Object(r.jsx)("footer",{children:Object(r.jsxs)("p",{children:["Another dumb project by ",Object(r.jsx)("a",{href:"https://stevehind.me",children:"Steve"}),"\xa9 2021."]})})]})},w=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,153)).then((function(e){var n=e.getCLS,r=e.getFID,i=e.getFCP,a=e.getLCP,o=e.getTTFB;n(t),r(t),i(t),a(t),o(t)}))};s.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(O,{})}),document.getElementById("root")),w()},73:function(t,e,n){"use strict";e.__esModule=!0;var r=n(38),i={retrieveStockInfoFromServer:function(t){return r.default({method:"POST",url:"http://localhost:5000/submit_single_holding",headers:{"Content-type":"application/json"},data:t}).then((function(t){if(200===t.status)return t.data;console.error(t)})).catch((function(t){return console.error(t)}))}};e.default=i},79:function(t,e,n){},80:function(t,e,n){},9:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{c(r.next(t))}catch(e){a(e)}}function s(t){try{c(r.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};e.__esModule=!0;var a=n(100);function o(t){return new Promise((function(e,n){return a.default.retrieveStockInfo(t.ticker).then((function(n){if(n.success){var r=n.data;return r.enriched=!0,r.portfolio=!1,r.shares_owned=t.shares_owned,r.capital_invested=s.capitalInvested(r),r.one_sigma_risk=s.oneSigmaRiskDollars(r),e(r)}var i=n.data;return i.ticker=t.ticker,i.enriched=!1,i.error_message=i.error_message,e(i)})).catch((function(t){return console.error(t)}))}))}var s={capitalInvested:function(t){return t.enriched?t.last_price_dollars*t.shares_owned:0},createSingleStockInfo:o,createStockInfoFromHoldings:function(t){return r(this,void 0,void 0,(function(){return i(this,(function(e){return[2,Promise.all(t.map((function(t){return o(t).then((function(t){return t})).catch((function(t){return t}))})))]}))}))},createPortfolio:function(t){return t.map((function(e){if(e.enriched){var n=s.capitalShare(e.ticker,t);e.capital_share=n;var r=s.oneSigmaRiskDollars(e);e.one_sigma_risk=r;var i=s.riskShare(e.ticker,t);return e.risk_share=i,e.portfolio=!0,e}return e}))},capitalTotal:function(t){return t.map((function(t){return t.capital_invested})).filter((function(t){return isNaN(t)?0:t})).reduce((function(t,e){return t+e}),0)},capitalShare:function(t,e){var n=s.capitalTotal(e),r=e.filter((function(e){return e.ticker===t}))[0];return r.enriched&&0!=r.capital_invested?r.capital_invested/n:0},oneSigmaRiskDollars:function(t){return t.enriched?t.opt_imp_vol_180d_pct*t.capital_invested:0},riskTotal:function(t){return t.map((function(t){return s.oneSigmaRiskDollars(t)})).reduce((function(t,e){return t+e}),0)},riskShare:function(t,e){var n=s.riskTotal(e),r=e.filter((function(e){return e.ticker===t}));return s.oneSigmaRiskDollars(r[0])/n}};e.default=s}},[[152,1,2]]]);
//# sourceMappingURL=main.964d4e77.chunk.js.map