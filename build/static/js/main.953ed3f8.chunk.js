(this["webpackJsonprisk-allocation"]=this["webpackJsonprisk-allocation"]||[]).push([[0],{100:function(t,e,r){"use strict";e.__esModule=!0;var n=r(38),i=r(101),a=r(151);var s={scrapeStockName:function(t){return new Promise((function(e,r){var a="https://www.alphaquery.com/stock/"+t+"/volatility-option-statistics/180-day/historical-volatility";n.get(a).then((function(t){var r=t.data,n=i.load(r)("#stock-header-container").children(".text-center").children("h1").text();return e(n)})).catch((function(t){return"Request failed with status code 404"===t.message?r({error_message:"This is probably not a valid stock ticker. Tickers should be 1-5 characters, excluding white spaces and leading $ character."}):r({error_message:t.message})}))}))},scrapeStockPrice:function(t){return new Promise((function(e,r){var a="https://www.alphaquery.com/stock/"+t+"/all-data-variables";n.get(a).then((function(t){var r=t.data,n=i.load(r)('a[name="Recent Price/Volume"]').parent().parent().next().children(".text-right").text(),a=parseFloat(n);return e(a)})).catch((function(t){return"Request failed with status code 404"===t.message?r({error_message:"This is probably not a valid stock ticker. Tickers should be 1-5 characters, excluding white spaces and leading $ character."}):r({error_message:t.message})}))}))},scrapeOptImpVol:function(t){return new Promise((function(e,r){var a="https://www.alphaquery.com/stock/"+t+"/volatility-option-statistics/180-day/historical-volatility";n.get(a).then((function(t){var r=t.data,n=i.load(r)("#indicator-iv-mean").children(".indicator-figure").children("a").children(".indicator-figure-inner").text(),a=parseFloat(n);return e(a)})).catch((function(t){return"Request failed with status code 404"===t.message?r({error_message:"This is probably not a valid stock ticker. Tickers should be 1-5 characters, excluding white spaces and leading $ character."}):r({error_message:t.message})}))}))},retrieveStockInfo:function(t){return new Promise((function(e,r){var n=a.default.sanitizeStockTicker(t);return s.scrapeStockPrice(n).then((function(t){return Promise.all([t,s.scrapeOptImpVol(n)])})).then((function(t){var e=t[0],r=t[1];return Promise.all([e,r,s.scrapeStockName(n)])})).then((function(t){var r=t[0],i=t[1],a=t[2];return e({success:!0,data:{verbose_name:a,ticker:n,last_price_dollars:r,opt_imp_vol_180d_pct:i,enriched:!0}})})).catch((function(t){return e({success:!1,data:t})}))}))}};e.default=s},151:function(t,e,r){"use strict";e.__esModule=!0;var n={sanitizeStockTicker:function(t){var e=function(t){return"$"===t.charAt(0)?t.substring(1):t}(t.toString().replace(/\s+/g,""));return e.length>=1&&e.length<=5?e:"This is probably not a valid stock ticker. Tickers should be 1-5 characters, excluding white spaces and leading $ character."}};e.default=n},152:function(t,e,r){"use strict";r.r(e);var n=r(0),i=r(5),a=r.n(i),s=r(70),o=r.n(s),c=(r(79),r(80),r(19)),l=r(20),d=r(21),u=r(23),h=r(22),p=r(37),_=r.n(p),f=r(71),b=r(72),m=r(73),j=r.n(m),v=function(t){Object(u.a)(r,t);var e=Object(h.a)(r);function r(t){var n;Object(c.a)(this,r),(n=e.call(this,t)).handleChange=function(t){var e=t.currentTarget.value,r=t.currentTarget.name;n.setState(Object(b.a)({},r,e),(function(){var t={ticker:n.state.ticker,shares_owned:n.state.shares_owned};n.setState({submission:t})}))},n.handleGetData=function(t){n.state.submission.ticker&&n.state.submission.shares_owned&&n.setState({submitted:!0},Object(f.a)(_.a.mark((function t(){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.a.retrieveStockInfoFromServer(n.state.submission).then((function(t){n.setState({index:n.props.index,verbose_name:t.verbose_name,capital_invested:t.capital_invested,last_price_dollars:t.last_price_dollars,opt_imp_vol_180d_pct:t.opt_imp_vol_180d_pct,one_sigma_risk:t.one_sigma_risk,error_message:t.error_message},(function(){n.props.onChange&&n.props.onChange(n.state)}))})).catch((function(t){return console.log(t)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))))},n.handleDelete=function(t){n.state.delete?n.setState({delete:!1},(function(){n.props.onDelete&&n.props.onDelete(n.props)})):n.setState({delete:!0},(function(){n.props.onDelete&&n.props.onDelete(n.props)}))};n.state={index:void 0,submitted:!1,ticker:void 0,verbose_name:void 0,shares_owned:void 0,submission:void 0,delete:!1,capital_invested:void 0,last_price_dollars:void 0,opt_imp_vol_180d_pct:void 0,one_sigma_risk:void 0,capital_share:void 0,risk_share:void 0,error_message:void 0};return n}return Object(l.a)(r,[{key:"render",value:function(){return Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{children:this.state.verbose_name?Object(n.jsx)("p",{children:this.state.verbose_name}):Object(n.jsx)("input",{type:"text",name:"ticker",placeholder:"Stock ticker",onChange:this.handleChange})}),Object(n.jsx)("td",{children:Object(n.jsx)("input",{type:"number",name:"shares_owned",placeholder:"Shares owned",onChange:this.handleChange})}),Object(n.jsx)("td",{children:Object(n.jsx)("button",{onClick:this.handleGetData,children:"Go!"})}),this.state.error_message?Object(n.jsx)("td",{colSpan:6,children:Object(n.jsx)("p",{style:{color:"red"},children:this.state.error_message})}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("td",{children:this.state.last_price_dollars?this.state.last_price_dollars:"..."}),Object(n.jsx)("td",{children:this.state.capital_invested?Math.round(this.state.capital_invested).toLocaleString():"..."}),Object(n.jsx)("td",{children:this.state.capital_share?(100*this.state.capital_share).toFixed(0)+"%":"..."}),Object(n.jsx)("td",{children:this.state.opt_imp_vol_180d_pct?(100*this.state.opt_imp_vol_180d_pct).toFixed(0)+"%":"..."}),Object(n.jsx)("td",{children:this.state.one_sigma_risk?Math.round(this.state.one_sigma_risk).toLocaleString():"..."}),Object(n.jsx)("td",{children:this.state.risk_share?(100*this.state.risk_share).toFixed(0)+"%":"..."})]}),Object(n.jsx)("td",{children:Object(n.jsx)("button",{onClick:this.handleDelete.bind(this),children:"Delete"})})]},this.props.index)}}],[{key:"getDerivedStateFromProps",value:function(t){return t.stateFromParent?{capital_share:t.stateFromParent.holding.capital_share,risk_share:t.stateFromParent.holding.risk_share}:{}}}]),r}(i.Component),g=r(9),k=r.n(g),x=function(t){Object(u.a)(r,t);var e=Object(h.a)(r);function r(t){var n;return Object(c.a)(this,r),(n=e.call(this,t)).makeRowKeys=function(){var t=n.state.row_counter,e=n.state.row_keys,r=Array(t);1===t?n.setState({row_keys:r}):n.setState({row_keys:e})},n.incrementRowCounter=function(){var t=n.state.row_counter+1;n.state.row_keys.push(t),n.setState({row_counter:t,row_keys:n.state.row_keys})},n.deleteSelectedRows=function(t){var e=n.state.row_keys.filter((function(e){return e!=t.index})),r=n.state.submitted_holdings.filter((function(e){return e.component_index!=t.index}));r=n.addPortfolioData(r),n.setState({row_keys:e,submitted_holdings:r},(function(){var t=n.state.submitted_holdings.map((function(t){return t.holding})),e=k.a.capitalTotal(t),r=k.a.riskTotal(t);n.setState({capital_total:e,risk_total:r})}))},n.collectChildState=function(t){var e={ticker:t.ticker,last_price_dollars:t.last_price_dollars,shares_owned:t.shares_owned,capital_invested:t.capital_invested,opt_imp_vol_180d_pct:t.opt_imp_vol_180d_pct,one_sigma_risk:t.one_sigma_risk,enriched:!0,portfolio:!1},r=n.state.submitted_holdings,i={component_index:t.index,holding:e},a=!1;r.map((function(e){e.component_index===t.index&&(a=!0,e.holding=i.holding)})),a||r.push(i),n.setState({submitted_holdings:r},(function(){var t=n.state.submitted_holdings.map((function(t){return t.holding})),e=k.a.capitalTotal(t),r=k.a.riskTotal(t);n.state.submitted_holdings.map((function(t){t.holding.capital_share=t.holding.capital_invested/e,t.holding.risk_share=t.holding.one_sigma_risk/r})),n.setState({risk_total:r,capital_total:e})}))},n.addPortfolioData=function(t){var e=t.map((function(t){return t.holding})),r=k.a.createPortfolio(e);return t.map((function(t,e){return t.holding=r[e],t}))},n.getStateForChild=function(t,e){return e.filter((function(e){return e.component_index===t}))[0]},n.sumCapital=function(t){var e=t.map((function(t){return t.holding}));n.setState({capital_total:k.a.capitalTotal(e)})},n.sumRisk=function(t){var e=t.map((function(t){return t.holding}));n.setState({risk_total:k.a.riskTotal(e)})},n.state={submitted_holdings:[],disabled:!0,holding_submitted:!1,row_counter:1,row_keys:[1],risk_total:0,capital_total:0},n.deleteSelectedRows=n.deleteSelectedRows.bind(Object(d.a)(n)),n}return Object(l.a)(r,[{key:"render",value:function(){var t=this;return Object(n.jsxs)("div",{children:[Object(n.jsxs)("table",{children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{children:"Stock ticker"}),Object(n.jsx)("th",{children:"Number of shares owned"}),Object(n.jsx)("th",{}),Object(n.jsx)("th",{children:"Last closing price ($)"}),Object(n.jsx)("th",{children:"Capital invested ($)"}),Object(n.jsx)("th",{children:"Share of capital"}),Object(n.jsx)("th",{children:"Options-implied volatility (one sigma)"}),Object(n.jsx)("th",{children:"One sigma risk ($)"}),Object(n.jsx)("th",{children:"Share of risk"}),Object(n.jsx)("th",{children:"Delete?"})]})}),Object(n.jsx)("tbody",{children:this.state.row_keys.map((function(e){return Object(n.jsx)(v,{index:e,stateFromParent:t.getStateForChild(e,t.state.submitted_holdings),onChange:t.collectChildState,onDelete:t.deleteSelectedRows},e)}))}),Object(n.jsx)("tfoot",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("td",{colSpan:3,children:Object(n.jsx)("b",{children:"Total:"})}),Object(n.jsx)("td",{}),Object(n.jsx)("td",{children:Math.round(this.state.capital_total).toLocaleString()}),Object(n.jsx)("td",{children:"100%"}),Object(n.jsx)("td",{}),Object(n.jsx)("td",{children:Math.round(this.state.risk_total).toLocaleString()}),Object(n.jsx)("td",{children:"100%"}),Object(n.jsx)("td",{})]})})]}),Object(n.jsx)("button",{onClick:this.incrementRowCounter,children:"Add another row"})]})}}]),r}(i.Component);var O=function(){return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)("header",{className:"App-header",children:Object(n.jsxs)("p",{children:["Enter your portfolio and see where your ",Object(n.jsx)("em",{children:"risk"})," is allocated."]})}),Object(n.jsx)("div",{className:"full-container",children:Object(n.jsx)("div",{className:"container padding-top",children:Object(n.jsx)(x,{})})}),Object(n.jsx)("footer",{children:Object(n.jsxs)("p",{children:["Another dumb project by ",Object(n.jsx)("a",{href:"https://stevehind.me",children:"Steve"}),"\xa9 2021."]})})]})},w=function(t){t&&t instanceof Function&&r.e(3).then(r.bind(null,153)).then((function(e){var r=e.getCLS,n=e.getFID,i=e.getFCP,a=e.getLCP,s=e.getTTFB;r(t),n(t),i(t),a(t),s(t)}))};o.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(O,{})}),document.getElementById("root")),w()},73:function(t,e,r){"use strict";e.__esModule=!0;var n=r(38),i={retrieveStockInfoFromServer:function(t){return n.default({method:"POST",url:"submit_single_holding",headers:{"Content-type":"application/json"},data:t}).then((function(t){if(200===t.status)return t.data;console.error(t)})).catch((function(t){return console.error(t)}))}};e.default=i},79:function(t,e,r){},80:function(t,e,r){},9:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,a){function s(t){try{c(n.next(t))}catch(e){a(e)}}function o(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,o)}c((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(o){a=[6,o],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};e.__esModule=!0;var a=r(100);function s(t){return new Promise((function(e,r){return a.default.retrieveStockInfo(t.ticker).then((function(r){if(r.success){var n=r.data;return n.enriched=!0,n.portfolio=!1,n.shares_owned=t.shares_owned,n.capital_invested=o.capitalInvested(n),n.one_sigma_risk=o.oneSigmaRiskDollars(n),e(n)}var i=r.data;return i.ticker=t.ticker,i.enriched=!1,i.error_message=i.error_message,e(i)})).catch((function(t){return console.error(t)}))}))}var o={capitalInvested:function(t){return t.enriched?t.last_price_dollars*t.shares_owned:0},createSingleStockInfo:s,createStockInfoFromHoldings:function(t){return n(this,void 0,void 0,(function(){return i(this,(function(e){return[2,Promise.all(t.map((function(t){return s(t).then((function(t){return t})).catch((function(t){return t}))})))]}))}))},createPortfolio:function(t){return t.map((function(e){if(e.enriched){var r=o.capitalShare(e.ticker,t);e.capital_share=r;var n=o.oneSigmaRiskDollars(e);e.one_sigma_risk=n;var i=o.riskShare(e.ticker,t);return e.risk_share=i,e.portfolio=!0,e}return e}))},capitalTotal:function(t){return t.map((function(t){return t.capital_invested})).filter((function(t){return isNaN(t)?0:t})).reduce((function(t,e){return t+e}),0)},capitalShare:function(t,e){var r=o.capitalTotal(e),n=e.filter((function(e){return e.ticker===t}))[0];return n.enriched&&0!=n.capital_invested?n.capital_invested/r:0},oneSigmaRiskDollars:function(t){return t.enriched?t.opt_imp_vol_180d_pct*Math.abs(t.capital_invested):0},riskTotal:function(t){return t.map((function(t){return o.oneSigmaRiskDollars(t)})).reduce((function(t,e){return t+Math.abs(e)}),0)},riskShare:function(t,e){var r=o.riskTotal(e),n=e.filter((function(e){return e.ticker===t}));return o.oneSigmaRiskDollars(n[0])/r}};e.default=o}},[[152,1,2]]]);
//# sourceMappingURL=main.953ed3f8.chunk.js.map