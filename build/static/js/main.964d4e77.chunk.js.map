{"version":3,"sources":["utils/retrieve_stock_info.js","utils/sanitize_stock_ticker.js","components/InputTableRow.tsx","components/InputTable.tsx","App.tsx","reportWebVitals.ts","index.tsx","api/apiHandlers.js","utils/capital_and_risk_calcs.js"],"names":["exports","__esModule","axios","require","cheerio","sanitize_stock_ticker","retrieve_stock_info","scrapeStockPrice","ticker","Promise","resolve","reject","scrape_target_url","get","then","response","response_html","data","last_child_text","load","$","parent","next","children","text","last_child_number","parseFloat","err","message","error_message","scrapeOptImpVol","option_implied_vol_string","opt_imp_vol_180d_pct","retrieveStockInfo","sanitized_ticker","sanitizeStockTicker","price","all","_a","vol","success","last_price_dollars","enriched","error","ticker_without_dollar_sign","charAt","substring","removeDollarSigns","toString","replace","length","module","InputTableRow","props","handleChange","event","value","currentTarget","name","setState","submission","state","shares_owned","handleGetData","submitted","a","api","retrieveStockInfoFromServer","index","capital_invested","one_sigma_risk","onChange","catch","console","log","handleDelete","delete","onDelete","undefined","capital_share","risk_share","type","placeholder","this","onClick","colSpan","style","color","Math","round","toLocaleString","toFixed","bind","stateFromParent","holding","React","InputTable","makeRowKeys","counter","row_counter","current_keys","row_keys","new_keys","Array","incrementRowCounter","new_counter","push","deleteSelectedRows","supplied_child_props","new_row_keys","filter","row","new_holdings","submitted_holdings","component_index","addPortfolioData","stock_array","map","indexed_holding","capital_total","cap_risk_calcs","capitalTotal","risk_total","riskTotal","collectChildState","child_state","stock_info","portfolio","existing_submitted_holdings","new_or_updated_holding","to_add","total_capital","total_risk","holdings","stock_array_enriched","createPortfolio","getStateForChild","sumCapital","stocks","sumRisk","disabled","holding_submitted","row_key","App","className","href","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","axios_1","method","url","HOST","headers","res","status","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","e","rejected","result","done","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","call","pop","retrieve_stock_info_1","createSingleStockInfo","submitted_holding","enriched_holding","capital_and_risk_calcs","capitalInvested","oneSigmaRiskDollars","unenriched_holding","createStockInfoFromHoldings","stock","capitalShare","riskShare","isNaN","reduce","r","d","b"],"mappings":"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","file":"static/js/main.964d4e77.chunk.js","sourcesContent":["\"use strict\";\nexports.__esModule = true;\nvar axios = require('axios');\nvar cheerio = require('cheerio');\nvar sanitize_stock_ticker = require('./sanitize_stock_ticker');\nfunction scrapeStockPrice(ticker) {\n    return new Promise(function (resolve, reject) {\n        var scrape_target_url = \"https://www.alphaquery.com/stock/\" + ticker + \"/all-data-variables\";\n        axios.get(scrape_target_url)\n            .then(function (response) {\n            var response_html = response.data;\n            var $ = cheerio.load(response_html);\n            var target = $('a[name=\"Recent Price/Volume\"]');\n            var first_parent = target.parent();\n            var second_parent = first_parent.parent();\n            var next_sibling = second_parent.next();\n            var last_child = next_sibling.children('.text-right');\n            var last_child_text = last_child.text();\n            var last_child_number = parseFloat(last_child_text);\n            return resolve(last_child_number);\n        })[\"catch\"](function (err) {\n            if (err.message === \"Request failed with status code 404\") {\n                return reject({\n                    error_message: 'This is probably not a valid stock ticker. Tickers should be 1-5 characters, excluding white spaces and leading $ character.'\n                });\n            }\n            else {\n                return reject({\n                    error_message: err.message\n                });\n            }\n        });\n    });\n}\nfunction scrapeOptImpVol(ticker) {\n    return new Promise(function (resolve, reject) {\n        var scrape_target_url = \"https://www.alphaquery.com/stock/\" + ticker + \"/volatility-option-statistics/180-day/historical-volatility\";\n        axios.get(scrape_target_url)\n            .then(function (response) {\n            var response_html = response.data;\n            var $ = cheerio.load(response_html);\n            var target = $('#indicator-iv-mean');\n            var child = target.children('.indicator-figure');\n            var next_child = child.children('a');\n            var further_child = next_child.children('.indicator-figure-inner');\n            var option_implied_vol_string = further_child.text();\n            var opt_imp_vol_180d_pct = parseFloat(option_implied_vol_string);\n            return resolve(opt_imp_vol_180d_pct);\n        })[\"catch\"](function (err) {\n            if (err.message === \"Request failed with status code 404\") {\n                return reject({\n                    error_message: 'This is probably not a valid stock ticker. Tickers should be 1-5 characters, excluding white spaces and leading $ character.'\n                });\n            }\n            else {\n                return reject({\n                    error_message: err.message\n                });\n            }\n        });\n    });\n}\nfunction retrieveStockInfo(ticker) {\n    return new Promise(function (resolve, reject) {\n        var sanitized_ticker = sanitize_stock_ticker.sanitizeStockTicker(ticker);\n        return retrieve_stock_info.scrapeStockPrice(sanitized_ticker)\n            .then(function (price) { return Promise.all([\n            price,\n            retrieve_stock_info.scrapeOptImpVol(sanitized_ticker)\n        ]); })\n            .then(function (_a) {\n            var price = _a[0], vol = _a[1];\n            var success_result = {\n                success: true,\n                data: {\n                    ticker: sanitized_ticker,\n                    last_price_dollars: price,\n                    opt_imp_vol_180d_pct: vol,\n                    enriched: true\n                }\n            };\n            return resolve(success_result);\n        })[\"catch\"](function (error) {\n            var failure_result = {\n                success: false,\n                data: error\n            };\n            return resolve(failure_result);\n        });\n    });\n}\nvar retrieve_stock_info = {\n    scrapeStockPrice: scrapeStockPrice,\n    scrapeOptImpVol: scrapeOptImpVol,\n    retrieveStockInfo: retrieveStockInfo\n};\nexports[\"default\"] = retrieve_stock_info;\n","function sanitizeStockTicker(ticker) {\n    var ticker_as_string = ticker.toString();\n    var ticker_without_spaces = ticker_as_string.replace(/\\s+/g, \"\");\n    function removeDollarSigns(ticker) {\n        if (ticker.charAt(0) === '$') {\n            return ticker.substring(1);\n        }\n        else {\n            return ticker;\n        }\n    }\n    var ticker_without_dollar_sign = removeDollarSigns(ticker_without_spaces);\n    if (ticker_without_dollar_sign.length >= 1 && ticker_without_dollar_sign.length <= 5) {\n        return ticker_without_dollar_sign;\n    }\n    else {\n        return 'This is probably not a valid stock ticker. Tickers should be 1-5 characters, excluding white spaces and leading $ character.';\n    }\n}\nvar sanitize_stock_ticker = {\n    sanitizeStockTicker: sanitizeStockTicker\n};\nmodule.exports = sanitize_stock_ticker;\n","import * as React from 'react';\nimport api from '../api/apiHandlers'\n\ntype Submission = {\n    ticker: string,\n    shares_owned: number\n}\n\ntype State = {\n    index: number,\n    submitted: boolean,\n    ticker: string | undefined,\n    shares_owned: number | undefined,\n    submission: Submission | undefined,\n    delete: boolean,\n    capital_invested: number | undefined,\n    last_price_dollars: number | undefined,\n    opt_imp_vol_180d_pct: number | undefined,\n    one_sigma_risk: number | undefined,\n    capital_share: number | undefined,\n    risk_share: number | undefined,\n    error_message: string | undefined\n}\n\ntype Props = {\n    key: number,\n    index: number,\n    onDelete: any,\n    onChange: any,\n    stateFromParent: any\n}\n\nclass InputTableRow extends React.Component<Props, State> {\n    constructor(props: Props) {\n        super(props);\n\n        const state: State = this.state = {\n            index: undefined,\n            submitted: false,\n            ticker: undefined,\n            shares_owned: undefined,\n            submission: undefined,\n            delete: false,\n            capital_invested: undefined,\n            last_price_dollars: undefined,\n            opt_imp_vol_180d_pct: undefined,\n            one_sigma_risk: undefined,\n            capital_share: undefined,\n            risk_share: undefined,\n            error_message: undefined\n        }\n    }\n\n    static getDerivedStateFromProps(props) {\n        if (props.stateFromParent) {\n            return {\n                capital_share: props.stateFromParent.holding.capital_share,\n                risk_share: props.stateFromParent.holding.risk_share\n            }\n        } else {\n            return {}\n        }\n    }\n\n    handleChange = (event: React.FormEvent<HTMLInputElement>) => {\n        const value = event.currentTarget.value;\n        const name = event.currentTarget.name;\n\n        this.setState({\n            \n            [name]: value\n        } as any, () => {\n            let submission = {\n                ticker: this.state.ticker,\n                shares_owned: this.state.shares_owned\n            }      \n            \n            this.setState({\n                submission: submission\n            })\n        })\n    }\n\n    handleGetData = (event: React.SyntheticEvent) => {\n        if (this.state.submission.ticker && this.state.submission.shares_owned) {\n\n            this.setState({\n                submitted: true\n            } as any, async() => {\n                return await api.retrieveStockInfoFromServer(this.state.submission)\n                .then(data => {\n                    this.setState({\n                        index: this.props.index,\n                        capital_invested: data.capital_invested,\n                        last_price_dollars: data.last_price_dollars,\n                        opt_imp_vol_180d_pct: data.opt_imp_vol_180d_pct,\n                        one_sigma_risk: data.one_sigma_risk,\n                        error_message: data.error_message \n                    }, () => {\n                        if (this.props.onChange) {\n                            this.props.onChange(this.state)\n                        }\n                    })\n                })\n                .catch(err => console.log(err))\n            })\n        }\n    }\n\n    handleDelete = (event: React.SyntheticEvent) => {\n        if (this.state.delete) {\n            this.setState({ delete: false }, () => {\n                if (this.props.onDelete) {\n                    this.props.onDelete(this.props)\n                }\n            })\n        } else {\n            this.setState({ delete: true }, () => {\n                if (this.props.onDelete) {\n                    this.props.onDelete(this.props)\n                }\n            })\n        }\n    }\n   \n    render() {\n        return (\n            <tr key={this.props.index}>\n                <td>\n                    <input\n                        type=\"text\"\n                        name=\"ticker\"\n                        placeholder=\"Stock ticker\"\n                        onChange={this.handleChange}\n                    />\n                </td>\n                <td>\n                    <input\n                        type=\"number\"\n                        name=\"shares_owned\"\n                        placeholder=\"Shares owned\"\n                        onChange={this.handleChange}\n                    />\n                </td>\n                <td>\n                    <button\n                        onClick={this.handleGetData}\n                    >\n                        Go!\n                    </button>\n                </td>\n                { this.state.error_message ?\n                <td colSpan={6}><p style={{color: \"red\"}} >{this.state.error_message}</p></td> :    \n                <>\n                    <td>{ this.state.last_price_dollars ? this.state.last_price_dollars : \"...\" }</td>\n                    <td>{ this.state.capital_invested ? Math.round(this.state.capital_invested).toLocaleString() : \"...\" }</td>\n                    <td>{ this.state.capital_share ? (this.state.capital_share * 100.0).toFixed(0)+\"%\" : \"...\" }</td>\n                    <td>{ this.state.opt_imp_vol_180d_pct ? (this.state.opt_imp_vol_180d_pct * 100.0).toFixed(0)+\"%\" : \"...\" }</td>\n                    <td>{ this.state.one_sigma_risk ? Math.round(this.state.one_sigma_risk).toLocaleString() : \"...\" }</td>\n                    <td>{ this.state.risk_share ? (this.state.risk_share * 100.0).toFixed(0)+\"%\" : \"...\" }</td>\n                </>\n                }\n                <td>\n                    <button \n                        onClick={this.handleDelete.bind(this)}\n                    >\n                        Delete\n                    </button>\n                </td>\n            </tr>\n        )\n    }\n}\n\nexport default InputTableRow;","import * as React from 'react';\nimport InputTableRow from './InputTableRow'\nimport cap_risk_calcs from '../utils/capital_and_risk_calcs'\nimport type { singleStockInfo } from '../utils/capital_and_risk_calcs'\n\ntype indexedHolding = {\n    component_index: number,\n    holding: singleStockInfo\n}\n\ntype Props = any;\ntype State = {\n    submitted_holdings: Array<indexedHolding>,\n    disabled: boolean,\n    holding_submitted: boolean,\n    row_counter: number,\n    row_keys: Array<number>,\n    capital_total: number,\n    risk_total: number\n}\n\ntype childState = {\n    index?: number,\n    capital_invested?: number,\n    delete?: boolean,\n    last_price_dollars?: number,\n    one_sigma_risk?: number,\n    opt_imp_vol_180d_pct?: number,\n    shares_owned?: number,\n    submission?: {ticker: string, shares_owned: string}\n    submitted?: boolean,\n    ticker?: string\n}\n\ntype suppliedChildProps = {\n    index: number,\n    onChange: any\n}\n\nclass InputTable extends React.Component<Props, State> {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            submitted_holdings: [],\n            disabled: true,\n            holding_submitted: false,\n            row_counter: 1,\n            row_keys: [1],\n            risk_total: 0,\n            capital_total: 0\n        }\n\n        this.deleteSelectedRows = this.deleteSelectedRows.bind(this)\n\n    }\n\n    makeRowKeys = () => {\n        let counter = this.state.row_counter\n        let current_keys = this.state.row_keys\n        let new_keys = Array(counter)\n\n        if (counter === 1) {\n            this.setState({ row_keys: new_keys })\n        } else {\n            this.setState({ row_keys: current_keys })\n        }        \n    }\n\n    incrementRowCounter = () => {\n        let new_counter: number = this.state.row_counter + 1\n        \n        this.state.row_keys.push(new_counter)\n\n        this.setState({\n            row_counter: new_counter,\n            row_keys: this.state.row_keys\n        })\n    }\n\n    deleteSelectedRows = (supplied_child_props: suppliedChildProps): void => {\n        let new_row_keys = this.state.row_keys.filter(row => row != supplied_child_props.index)\n        let new_holdings = this.state.submitted_holdings.filter(holding => holding.component_index != supplied_child_props.index)\n        new_holdings = this.addPortfolioData(new_holdings)\n\n        this.setState({\n            row_keys: new_row_keys,\n            submitted_holdings: new_holdings,\n        }, () => {\n            let stock_array: Array<singleStockInfo> = this.state.submitted_holdings.map(indexed_holding => indexed_holding.holding)\n            let capital_total: number = cap_risk_calcs.capitalTotal(stock_array)\n            let risk_total: number = cap_risk_calcs.riskTotal(stock_array)\n\n            this.setState({\n                capital_total: capital_total,\n                risk_total: risk_total\n            })\n        })\n    }\n\n    collectChildState = (child_state: childState) => {\n        console.log(\"Collect child state started!\")\n        console.log(\"Child state is: %o\", child_state)\n\n        let stock_info: singleStockInfo = {\n            ticker: child_state.ticker,\n            last_price_dollars: child_state.last_price_dollars,\n            shares_owned: child_state.shares_owned,\n            capital_invested: child_state.capital_invested,\n            opt_imp_vol_180d_pct: child_state.opt_imp_vol_180d_pct,\n            one_sigma_risk: child_state.one_sigma_risk,\n            enriched: true,\n            portfolio: false\n        }\n\n        let existing_submitted_holdings = this.state.submitted_holdings\n\n        let new_or_updated_holding: indexedHolding = {\n            component_index: child_state.index,\n            holding: stock_info\n        }\n        let to_add: boolean = false\n\n        console.log(\"new_or_updated holding is: %o\", new_or_updated_holding)\n\n        existing_submitted_holdings.map((indexed_holding: indexedHolding) => {\n            if (indexed_holding.component_index === child_state.index) {\n                to_add = true\n                indexed_holding.holding = new_or_updated_holding.holding\n            }\n        })\n\n        if (!to_add) {\n            console.log(\"adding a new holding\")\n            existing_submitted_holdings.push(new_or_updated_holding)\n        }\n\n        this.setState({\n            submitted_holdings: existing_submitted_holdings\n        }, () => {\n            let stock_array: Array<singleStockInfo> = this.state.submitted_holdings.map(indexed_holding => indexed_holding.holding)\n            let total_capital: number = cap_risk_calcs.capitalTotal(stock_array)\n            let total_risk: number = cap_risk_calcs.riskTotal(stock_array)\n\n            this.state.submitted_holdings.map(indexed_holding => {\n                indexed_holding.holding.capital_share = indexed_holding.holding.capital_invested / total_capital\n                indexed_holding.holding.risk_share = indexed_holding.holding.one_sigma_risk / total_risk\n            })\n\n            this.setState({\n                risk_total: total_risk,\n                capital_total: total_capital\n            })\n        })\n    }\n\n    addPortfolioData = (holdings: Array<indexedHolding>): Array<indexedHolding> => {\n        let stock_array: Array<singleStockInfo> = holdings.map(holding => holding.holding)\n\n        let stock_array_enriched = cap_risk_calcs.createPortfolio(stock_array)\n\n        let new_holdings = holdings.map((holding, index) => {\n            holding.holding = stock_array_enriched[index]\n            return holding\n        })\n        return new_holdings    \n    }\n\n    getStateForChild = (index, holdings: Array<indexedHolding>): indexedHolding => {\n        let state_for_this_child = holdings.filter(holding => holding.component_index === index)[0]\n        return state_for_this_child\n    }\n\n    sumCapital = (holdings: Array<indexedHolding>): void => {\n        let stocks = holdings.map(holding => holding.holding)\n        this.setState({\n            capital_total: cap_risk_calcs.capitalTotal(stocks)\n        })\n    }\n\n    sumRisk = (holdings: Array<indexedHolding>): void => {\n        let stocks = holdings.map(holding => holding.holding)\n        this.setState({\n            risk_total: cap_risk_calcs.riskTotal(stocks)\n        })  \n    }\n\n    render() {\n        return (\n            <div>\n                <table>\n                    <thead>\n                        <tr>\n                            <th>Stock ticker</th>\n                            <th>Number of shares owned</th>\n                            <th></th>\n                            <th>Last closing price ($)</th>\n                            <th>Capital invested ($)</th>\n                            <th>Share of capital</th>\n                            <th>Options-implied volatility (one sigma)</th>\n                            <th>One sigma risk ($)</th>\n                            <th>Share of risk</th>\n                            <th>Delete?</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {\n                            this.state.row_keys.map(\n                                (row_key: number) => {\n                                    return <InputTableRow\n                                        key={row_key}\n                                        index={row_key}\n                                        stateFromParent={this.getStateForChild(row_key, this.state.submitted_holdings)}\n                                        onChange={this.collectChildState}\n                                        onDelete={this.deleteSelectedRows}\n                                    />\n                                }\n                            )\n                        }\n                    </tbody>\n                    <tfoot>\n                        <tr>\n                            <td colSpan={3}><b>Total:</b></td>\n                            <td></td>\n                            <td>\n                                { Math.round(this.state.capital_total).toLocaleString() }\n                            </td>\n                            <td>\n                                100%\n                            </td>\n                            <td></td>\n                            <td>\n                            { Math.round(this.state.risk_total).toLocaleString() }\n                            </td>\n                            <td>\n                                100%\n                            </td>\n                            <td></td>\n                        </tr>\n                    </tfoot>\n                </table>\n                <button\n                    onClick={this.incrementRowCounter}\n                >\n                    Add another row\n                </button>\n            </div>\n        )\n    }\n}\n\nexport default InputTable","import React from 'react';\nimport './App.css';\nimport InputTable from './components/InputTable'\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        {/* <img src={logo} className=\"App-logo\" alt=\"logo\" /> */}\n        <p>\n          Enter your portfolio and see where your <em>risk</em> is allocated.\n        </p>\n      </header>\n      <div className=\"full-container\">\n        <div className=\"container padding-top\">\n          <InputTable/>\n        </div>\n      </div>\n      <footer>\n        <p>Another dumb project by <a href=\"https://stevehind.me\">Steve</a>© 2021.</p>\n      </footer>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","\"use strict\";\nexports.__esModule = true;\nvar axios_1 = require(\"axios\");\nvar HOST = 'http://localhost:5000/';\nvar retrieveStockInfoFromServer = function (submission) {\n    return axios_1[\"default\"]({\n        method: \"POST\",\n        url: HOST + \"submit_single_holding\",\n        headers: {\n            \"Content-type\": \"application/json\"\n        },\n        data: submission\n    })\n        .then(function (res) {\n        if (res.status === 200) {\n            return res.data;\n        }\n        else {\n            console.error(res);\n        }\n    })[\"catch\"](function (err) { return console.error(err); });\n};\nvar api = {\n    retrieveStockInfoFromServer: retrieveStockInfoFromServer\n};\nexports[\"default\"] = api;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nexports.__esModule = true;\nvar retrieve_stock_info_1 = require(\"./retrieve_stock_info\");\nfunction capitalInvested(stock_info) {\n    if (stock_info.enriched) {\n        return stock_info.last_price_dollars * stock_info.shares_owned;\n    }\n    return 0;\n}\nfunction capitalTotal(portfolio) {\n    var capital_per_holding = portfolio.map(function (holding) { return holding.capital_invested; });\n    var capital_per_holding_less_NaNs = capital_per_holding.filter(function (value) {\n        if (isNaN(value)) {\n            return 0;\n        }\n        else {\n            return value;\n        }\n    });\n    return capital_per_holding_less_NaNs.reduce(function (r, d) { return r + d; }, 0);\n}\nfunction capitalShare(ticker, portfolio) {\n    var total_capital = capital_and_risk_calcs.capitalTotal(portfolio);\n    // this doesn't handle the edge case where the same stock ticker is provided twice in the array\n    var holding = portfolio.filter(function (stock) { return stock.ticker === ticker; })[0];\n    if ((holding.enriched) && (holding.capital_invested != 0)) {\n        var capital_invested = holding.capital_invested;\n        return capital_invested / total_capital;\n    }\n    else {\n        return 0;\n    }\n}\nfunction oneSigmaRiskDollars(stock) {\n    if (stock.enriched) {\n        return stock.opt_imp_vol_180d_pct * stock.capital_invested;\n    }\n    else {\n        return 0;\n    }\n}\nfunction riskTotal(portfolio) {\n    var stock_risks = portfolio.map(function (stock) {\n        return capital_and_risk_calcs.oneSigmaRiskDollars(stock);\n    });\n    return stock_risks.reduce(function (a, b) { return a + b; }, 0);\n}\nfunction riskShare(ticker, portfolio) {\n    var total_risk = capital_and_risk_calcs.riskTotal(portfolio);\n    var holding = portfolio.filter(function (stock) { return stock.ticker === ticker; });\n    var holding_risk = capital_and_risk_calcs.oneSigmaRiskDollars(holding[0]);\n    return holding_risk / total_risk;\n}\nfunction createSingleStockInfo(submitted_holding) {\n    return new Promise(function (resolve, reject) {\n        return retrieve_stock_info_1[\"default\"].retrieveStockInfo(submitted_holding.ticker)\n            .then(function (response) {\n            if (response.success) {\n                // @ts-ignore\n                var enriched_holding = response.data;\n                enriched_holding.enriched = true;\n                enriched_holding.portfolio = false;\n                enriched_holding.shares_owned = submitted_holding.shares_owned;\n                enriched_holding.capital_invested = capital_and_risk_calcs.capitalInvested(enriched_holding);\n                enriched_holding.one_sigma_risk = capital_and_risk_calcs.oneSigmaRiskDollars(enriched_holding);\n                return resolve(enriched_holding);\n            }\n            else {\n                // @ts-ignore\n                var unenriched_holding = response.data;\n                unenriched_holding.ticker = submitted_holding.ticker;\n                unenriched_holding.enriched = false;\n                unenriched_holding.error_message = unenriched_holding.error_message;\n                return resolve(unenriched_holding);\n            }\n        })[\"catch\"](function (err) { return console.error(err); });\n    });\n}\nfunction createStockInfoFromHoldings(submitted_holdings) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2 /*return*/, Promise.all(submitted_holdings.map(function (submitted_holding) {\n                    return createSingleStockInfo(submitted_holding)\n                        .then(function (result) {\n                        return result;\n                    })[\"catch\"](function (error) { return error; });\n                }))];\n        });\n    });\n}\nfunction createPortfolio(stock_array) {\n    return stock_array.map(function (stock) {\n        if (stock.enriched) {\n            var capital_share = capital_and_risk_calcs.capitalShare(stock.ticker, stock_array);\n            stock.capital_share = capital_share;\n            var one_sigma_risk = capital_and_risk_calcs.oneSigmaRiskDollars(stock);\n            stock.one_sigma_risk = one_sigma_risk;\n            var risk_share = capital_and_risk_calcs.riskShare(stock.ticker, stock_array);\n            stock.risk_share = risk_share;\n            stock.portfolio = true;\n            return stock;\n        }\n        else {\n            return stock;\n        }\n    });\n}\nvar capital_and_risk_calcs = {\n    capitalInvested: capitalInvested,\n    createSingleStockInfo: createSingleStockInfo,\n    createStockInfoFromHoldings: createStockInfoFromHoldings,\n    createPortfolio: createPortfolio,\n    capitalTotal: capitalTotal,\n    capitalShare: capitalShare,\n    oneSigmaRiskDollars: oneSigmaRiskDollars,\n    riskTotal: riskTotal,\n    riskShare: riskShare\n};\nexports[\"default\"] = capital_and_risk_calcs;\n"],"sourceRoot":""}